(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[436],{8666:function(e,t,r){Promise.resolve().then(r.bind(r,7168)),Promise.resolve().then(r.bind(r,5100))},1391:function(e,t,r){"use strict";r.d(t,{default:function(){return b}});var n=r(7437),l=r(6648),s=r(7573),a=r(8094),c=r(2265),i=r(4667);function u(e){let{url_preview:t,cardId:r}=e,{activeAudioId:l,setActiveAudioId:u}=(0,i.Q)(),o=(0,c.useRef)(null);return(0,c.useEffect)(()=>{let e=o.current,t=()=>{u(null)};return e&&e.addEventListener("ended",t),()=>{e&&e.removeEventListener("ended",t)}},[u]),(0,c.useEffect)(()=>{o.current&&l!==r&&o.current.pause()},[l,r]),(0,n.jsxs)(n.Fragment,{children:[l===r?(0,n.jsx)("button",{className:"btn btn-circle btn-secondary btn-sm",onClick:()=>{o.current&&(o.current.pause(),u(null))},children:(0,n.jsx)(s.Z,{className:"w-4 h-4"})}):(0,n.jsx)("button",{className:"btn btn-circle btn-primary btn-sm",onClick:()=>{o.current&&(o.current.play(),u(r))},children:(0,n.jsx)(a.Z,{className:"w-4 h-4"})}),(0,n.jsx)("audio",{ref:o,src:t})]})}var o=r(8472),d=r(8125),h=r(4697);function x(e){let{cardId:t,onDelete:r}=e,[l,s]=(0,c.useState)(!1),[a,i]=(0,c.useState)(null),{token:u}=(0,d.a)(),x=async()=>{s(!0),i(null);try{let e="http://localhost:3000/deleteMusic/".concat(t);await o.Z.delete(e,{headers:{Authorization:"Bearer ".concat(u)}}),r(t)}catch(e){i("Failed to delete the music. Please try again.")}finally{s(!1)}};return(0,n.jsx)("button",{onClick:x,disabled:l,className:"btn btn-circle btn-secondary btn-sm",children:(0,n.jsx)(h.Z,{})})}function f(e){let{children:t}=e;return(0,n.jsx)("div",{className:"card-actions justify-end flex-row",children:t})}var m=r(6273);function j(e){let{artiste:t,titre:r,url_preview:l,url_cover_album_big:s}=e,{token:a}=(0,d.a)(),c=async()=>{try{await o.Z.post("http://localhost:3000/addMusic",{artiste:t,titre:r,url_preview:l,url_cover_album_big:s},{headers:{Authorization:"Bearer ".concat(a)}})}catch(e){console.log(e)}};return(0,n.jsx)("button",{onClick:c,className:"btn btn-circle btn-secondary btn-sm",children:(0,n.jsx)(m.Z,{})})}function b(e){let{cardId:t,name_artist:r,name_song:s,url_preview:a,url_cover_album_big:i,nom:o="raffoul",prenom:d="pierre",audioButton:h=!1,size:m="h-full w-full",withBlock:b=!1,deleteButton:v=!1,addButton:p=!1}=e,[w,_]=(0,c.useState)(!1),g=e=>{_(!0)};return w?null:(0,n.jsx)(n.Fragment,{children:b?(0,n.jsx)("div",{className:"w-[220px] h-[360px] bg-sky-950 rounded-2xl",children:(0,n.jsxs)("div",{className:"card glass ".concat(m),children:[(0,n.jsx)("figure",{className:"h-50",children:(0,n.jsx)(l.default,{className:"object-contain",src:i,alt:r+" "+s,width:500,height:500,objectFit:"contain",priority:!0})}),(0,n.jsxs)("div",{className:"card-body p-4",children:[(0,n.jsx)("h2",{className:"card-title text-sm",children:s}),(0,n.jsx)("p",{className:"text-xs",children:r}),(0,n.jsxs)("p",{className:"text-xs",children:["liked by ",(0,n.jsx)("em",{children:d+" "+o})]}),(0,n.jsxs)(f,{children:[v?(0,n.jsx)(x,{cardId:t,onDelete:g}):null,p?(0,n.jsx)(j,{titre:s,artiste:r,url_preview:a,url_cover_album_big:i}):null,h?(0,n.jsx)(u,{url_preview:a,cardId:t}):null]})]})]})}):(0,n.jsxs)("div",{className:"card glass ".concat(m),children:[(0,n.jsx)("figure",{className:"h-50",children:(0,n.jsx)(l.default,{className:"object-contain",src:i,alt:r+" "+s,width:500,height:500,objectFit:"contain",priority:!0})}),(0,n.jsxs)("div",{className:"card-body p-4",children:[(0,n.jsx)("h2",{className:"card-title text-sm",children:s}),(0,n.jsx)("p",{className:"text-xs",children:r}),(0,n.jsxs)("p",{className:"text-xs",children:["liked by ",(0,n.jsx)("em",{children:d+" "+o})]}),(0,n.jsxs)(f,{children:[v?(0,n.jsx)(x,{cardId:t,onDelete:g}):null,p?(0,n.jsx)(j,{titre:s,artiste:r,url_preview:a,url_cover_album_big:i}):null,h?(0,n.jsx)(u,{url_preview:a,cardId:t}):null]})]})]})})}},4667:function(e,t,r){"use strict";r.d(t,{AudioProvider:function(){return a},Q:function(){return c}});var n=r(7437),l=r(2265);let s=(0,l.createContext)(void 0),a=e=>{let{children:t}=e,[r,a]=(0,l.useState)(null),c=(0,l.useCallback)(e=>{a(e)},[]);return(0,n.jsx)(s.Provider,{value:{activeAudioId:r,setActiveAudioId:c},children:t})},c=()=>{let e=(0,l.useContext)(s);if(void 0===e)throw Error("useAudio must be used within an AudioProvider");return e}},8125:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return a},a:function(){return c}});var n=r(7437),l=r(2265);let s=(0,l.createContext)(void 0),a=e=>{let{children:t}=e,[r,a]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let e=localStorage.getItem("token");e&&a(e)},[]),(0,l.useEffect)(()=>{r?localStorage.setItem("token",r):localStorage.removeItem("token")},[r]),(0,n.jsx)(s.Provider,{value:{token:r,setToken:a,login:e=>{a(e)},logout:()=>{a(null),window.location.href="/"}},children:t})},c=()=>{let e=(0,l.useContext)(s);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}},7168:function(e,t,r){"use strict";r.d(t,{default:function(){return s}});var n=r(7437),l=r(8125);function s(){let{logout:e}=(0,l.a)();return(0,n.jsx)("li",{onClick:e,children:(0,n.jsx)("a",{children:"Deconnexion"})})}},5100:function(e,t,r){"use strict";r.d(t,{default:function(){return u}});var n=r(7437),l=r(1391),s=r(8125),a=r(2265),c=r(8472);let i=async e=>{try{return(await c.Z.get("http://localhost:3000/getMusic/",{headers:{Authorization:"Bearer ".concat(e)}})).data}catch(e){return console.log(e),null}};function u(){let{token:e}=(0,s.a)(),[t,r]=(0,a.useState)([]),[c,u]=(0,a.useState)(null);return(0,a.useEffect)(()=>{(async()=>{if(e){let t=await i(e);t&&(r(t.musiques),u(t.utilisateur))}})()},[e]),(0,n.jsx)("div",{className:"w-full h-auto flex flex-row justify-center items-center flex-wrap gap-10 p-10",children:t.map(e=>(0,n.jsx)(l.default,{cardId:e.id,name_artist:e.artiste,name_song:e.titre,url_preview:e.url_preview||"",url_cover_album_big:e.url_cover_album_big||"",nom:(null==c?void 0:c.nom)||"",prenom:(null==c?void 0:c.prenom)||"",audioButton:!0,withBlock:!0,deleteButton:!0},e.id))})}}},function(e){e.O(0,[472,215,971,23,744],function(){return e(e.s=8666)}),_N_E=e.O()}]);